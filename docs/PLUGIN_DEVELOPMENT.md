# æ’ä»¶å¼€å‘æŒ‡å—

## ğŸ“‘ ç›®å½•

-   [æ’ä»¶ç³»ç»Ÿæ¦‚è¿°](#æ’ä»¶ç³»ç»Ÿæ¦‚è¿°)
    -   [æ’ä»¶ç³»ç»Ÿæ¶æ„](#æ’ä»¶ç³»ç»Ÿæ¶æ„)
    -   [æ’ä»¶ç”Ÿå‘½å‘¨æœŸ](#æ’ä»¶ç”Ÿå‘½å‘¨æœŸ)
    -   [æ’ä»¶ä¾èµ–ç®¡ç†](#æ’ä»¶ä¾èµ–ç®¡ç†)
-   [åˆ›å»ºæ’ä»¶](#åˆ›å»ºæ’ä»¶)
    -   [åˆ›å»ºæ’ä»¶ç›®å½•](#åˆ›å»ºæ’ä»¶ç›®å½•)
    -   [å®šä¹‰æ’ä»¶æ¥å£](#å®šä¹‰æ’ä»¶æ¥å£)
    -   [å®ç°æ’ä»¶é€»è¾‘](#å®ç°æ’ä»¶é€»è¾‘)
    -   [æ³¨å†Œæ’ä»¶](#æ³¨å†Œæ’ä»¶)
-   [æ’ä»¶å¼€å‘æœ€ä½³å®è·µ](#æ’ä»¶å¼€å‘æœ€ä½³å®è·µ)
    -   [æ’ä»¶è®¾è®¡åŸåˆ™](#æ’ä»¶è®¾è®¡åŸåˆ™)
    -   [æ’ä»¶æµ‹è¯•](#æ’ä»¶æµ‹è¯•)
    -   [æ’ä»¶æ–‡æ¡£](#æ’ä»¶æ–‡æ¡£)
    -   [æ’ä»¶ç‰ˆæœ¬ç®¡ç†](#æ’ä»¶ç‰ˆæœ¬ç®¡ç†)
-   [æ’ä»¶ç¤ºä¾‹](#æ’ä»¶ç¤ºä¾‹)
    -   [Hello World æ’ä»¶](#hello-world-æ’ä»¶)
    -   [æ•°æ®æ’ä»¶](#æ•°æ®æ’ä»¶)
    -   [API æ’ä»¶](#api-æ’ä»¶)
    -   [é›†æˆæ’ä»¶](#é›†æˆæ’ä»¶)
-   [æ’ä»¶é€šä¿¡](#æ’ä»¶é€šä¿¡)
    -   [äº‹ä»¶æœºåˆ¶](#äº‹ä»¶æœºåˆ¶)
    -   [æœåŠ¡è°ƒç”¨](#æœåŠ¡è°ƒç”¨)
    -   [æ•°æ®å…±äº«](#æ•°æ®å…±äº«)
-   [æ’ä»¶çƒ­åŠ è½½](#æ’ä»¶çƒ­åŠ è½½)
    -   [çƒ­åŠ è½½æœºåˆ¶](#çƒ­åŠ è½½æœºåˆ¶)
    -   [çƒ­åŠ è½½é…ç½®](#çƒ­åŠ è½½é…ç½®)
    -   [çƒ­åŠ è½½æœ€ä½³å®è·µ](#çƒ­åŠ è½½æœ€ä½³å®è·µ)
-   [ç°æœ‰æ’ä»¶å‚è€ƒ](#ç°æœ‰æ’ä»¶å‚è€ƒ)
    -   [é›†æˆç±»æ’ä»¶](#é›†æˆç±»æ’ä»¶)
    -   [ä¸šåŠ¡åŠŸèƒ½æ’ä»¶](#ä¸šåŠ¡åŠŸèƒ½æ’ä»¶)
    -   [æ’ä»¶å‚è€ƒä»£ç ](#æ’ä»¶å‚è€ƒä»£ç )
-   [æ’ä»¶å‘å¸ƒ](#æ’ä»¶å‘å¸ƒ)
    -   [æ’ä»¶æ‰“åŒ…](#æ’ä»¶æ‰“åŒ…)
    -   [æ’ä»¶å‘å¸ƒåˆ° npm](#æ’ä»¶å‘å¸ƒåˆ°-npm)
    -   [æ’ä»¶å‘å¸ƒåˆ°ç§æœ‰ä»“åº“](#æ’ä»¶å‘å¸ƒåˆ°ç§æœ‰ä»“åº“)
-   [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
    -   [å¼€å‘ç›¸å…³](#å¼€å‘ç›¸å…³)
    -   [æµ‹è¯•ç›¸å…³](#æµ‹è¯•ç›¸å…³)
    -   [éƒ¨ç½²ç›¸å…³](#éƒ¨ç½²ç›¸å…³)

---

## æ’ä»¶ç³»ç»Ÿæ¦‚è¿°

### æ’ä»¶ç³»ç»Ÿæ¶æ„

OKSAI å¹³å°é‡‡ç”¨æ’ä»¶åŒ–æ¶æ„ï¼Œæ”¯æŒåŠŸèƒ½çš„åŠ¨æ€æ‰©å±•å’Œå®šåˆ¶ã€‚

**æ’ä»¶ç³»ç»Ÿæ¶æ„ï¼š**

```mermaid
graph TB
    Core[Core Module]
    PluginSystem[Plugin System]
    Plugin1[Plugin 1]
    Plugin2[Plugin 2]
    Plugin3[Plugin 3]

    Core --> PluginSystem
    PluginSystem --> Plugin1
    PluginSystem --> Plugin2
    PluginSystem --> Plugin3

    Plugin1 --> EventSystem[Event System]
    Plugin2 --> EventSystem
    Plugin3 --> EventSystem
```

### æ’ä»¶ç”Ÿå‘½å‘¨æœŸ

æ’ä»¶ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬åˆ›å»ºã€æ³¨å†Œã€åˆå§‹åŒ–ã€è¿è¡Œã€é”€æ¯ç­‰é˜¶æ®µã€‚

**æ’ä»¶ç”Ÿå‘½å‘¨æœŸï¼š**

```mermaid
stateDiagram-v2
    [*] --> Created: Plugin Created
    Created --> Registered: Register Plugin
    Registered --> Initialized: onPluginInit
    Initialized --> Bootstrapped: onPluginBootstrap
    Bootstrapped --> Running: Start Application
    Running --> Destroying: onPluginDestroy
    Destroying --> [*]: Plugin Destroyed
```

### æ’ä»¶ä¾èµ–ç®¡ç†

æ’ä»¶å¯ä»¥å£°æ˜ä¾èµ–å…³ç³»ï¼Œç¡®ä¿æŒ‰æ­£ç¡®é¡ºåºåŠ è½½ã€‚

**æ’ä»¶ä¾èµ–å…³ç³»ï¼š**

```mermaid
graph TD
    Plugin1[Plugin 1]
    Plugin2[Plugin 2]
    Plugin3[Plugin 3]
    Core[@oksai/core]

    Plugin1 --> Core
    Plugin2 --> Core
    Plugin2 --> Plugin1
    Plugin3 --> Core
    Plugin3 --> Plugin2
```

---

## åˆ›å»ºæ’ä»¶

### åˆ›å»ºæ’ä»¶ç›®å½•

åœ¨ `libs/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„æ’ä»¶ç›®å½•ï¼š

```bash
mkdir -p libs/plugins/<plugin-name>/src/lib
```

### å®šä¹‰æ’ä»¶æ¥å£

å®ç°æ’ä»¶æ¥å£ï¼Œå®šä¹‰æ’ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚

**æ’ä»¶æ¥å£å®šä¹‰ï¼š**

```typescript
import { IOksaisPluginBootstrap, IOksaisPluginDestroy } from '@oksai/plugin';

export class MyPlugin implements IOksaisPluginBootstrap, IOksaisPluginDestroy {
	dependencies = ['@oksai/core'];

	async onPluginBootstrap(): Promise<void> {
		console.log('MyPlugin initialized');
	}

	async onPluginDestroy(): Promise<void> {
		console.log('MyPlugin destroyed');
	}
}
```

### å®ç°æ’ä»¶é€»è¾‘

å®ç°æ’ä»¶çš„ä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬ Serviceã€Controllerã€Entity ç­‰ã€‚

**æ’ä»¶ Serviceï¼š**

```typescript
@Injectable()
export class MyPluginService {
	private readonly logger = new Logger(MyPluginService.name);

	async doSomething(): Promise<string> {
		this.logger.log('Doing something...');
		return 'Done';
	}
}
```

**æ’ä»¶ Controllerï¼š**

```typescript
@Controller('my-plugin')
export class MyPluginController {
	constructor(private readonly myPluginService: MyPluginService) {}

	@Get()
	async index(): Promise<string> {
		return await this.myPluginService.doSomething();
	}
}
```

**æ’ä»¶ Moduleï¼š**

```typescript
@Module({
	providers: [MyPluginService],
	controllers: [MyPluginController]
})
export class MyPluginModule {}
```

### æ³¨å†Œæ’ä»¶

åœ¨ `AppModule` ä¸­æ³¨å†Œæ’ä»¶ï¼š

```typescript
@Module({
	imports: [MyPluginModule],
	providers: [MyPlugin]
})
export class AppModule {}
```

---

## æ’ä»¶å¼€å‘æœ€ä½³å®è·µ

### æ’ä»¶è®¾è®¡åŸåˆ™

**æ’ä»¶è®¾è®¡åŸåˆ™ï¼š**

-   **å•ä¸€èŒè´£** - æ¯ä¸ªæ’ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
-   **ä¾èµ–æœ€å°åŒ–** - æœ€å°åŒ–æ’ä»¶ä¹‹é—´çš„ä¾èµ–
-   **æ¥å£éš”ç¦»** - ä½¿ç”¨æ¥å£éš”ç¦»æ’ä»¶
-   **æ˜“äºæ‰©å±•** - è®¾è®¡æ˜“äºæ‰©å±•çš„æ’ä»¶

### æ’ä»¶æµ‹è¯•

**æ’ä»¶æµ‹è¯•ç¤ºä¾‹ï¼š**

```typescript
import { Test, TestingModule } from '@nestjs/testing';
import { MyPluginService } from './my-plugin.service';

describe('MyPluginService', () => {
	let service: MyPluginService;

	beforeEach(async () => {
		const module: TestingModule = await Test.createTestingModule({
			providers: [MyPluginService]
		}).compile();

		service = module.get<MyPluginService>(MyPluginService);
	});

	it('should be defined', () => {
		expect(service).toBeDefined();
	});

	it('should do something', async () => {
		const result = await service.doSomething();
		expect(result).toBe('Done');
	});
});
```

### æ’ä»¶æ–‡æ¡£

**æ’ä»¶æ–‡æ¡£åº”è¯¥åŒ…å«ï¼š**

-   æ’ä»¶ç®€ä»‹
-   åŠŸèƒ½è¯´æ˜
-   å®‰è£…æŒ‡å—
-   é…ç½®è¯´æ˜
-   ä½¿ç”¨ç¤ºä¾‹
-   API æ–‡æ¡£

### æ’ä»¶ç‰ˆæœ¬ç®¡ç†

**æ’ä»¶ç‰ˆæœ¬ç®¡ç†ï¼š**

-   éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆSemantic Versioningï¼‰
-   ç‰ˆæœ¬å·æ ¼å¼ï¼š`MAJOR.MINOR.PATCH`
-   `MAJOR` - ä¸å…¼å®¹çš„ API å˜æ›´
-   `MINOR` - å‘åå…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
-   `PATCH` - å‘åå…¼å®¹çš„é—®é¢˜ä¿®æ­£

---

## æ’ä»¶ç¤ºä¾‹

### Hello World æ’ä»¶

**æ’ä»¶ä»£ç ï¼š**

```typescript
import { Injectable } from '@nestjs/common';
import * as chalk from 'chalk';
import { IOksaisPluginBootstrap, IOksaisPluginDestroy } from '@oksai/plugin';

@Injectable()
export class HelloWorldPlugin implements IOksaisPluginBootstrap, IOksaisPluginDestroy {
	async onPluginBootstrap(): Promise<void> {
		console.log(chalk.green('âœ“ Hello World Plugin initialized'));
	}

	async onPluginDestroy(): Promise<void> {
		console.log(chalk.red('âœ— Hello World Plugin destroyed'));
	}
}
```

### æ•°æ®æ’ä»¶

**æ’ä»¶å®ä½“ï¼š**

```typescript
import { Entity, Property } from '@mikro-orm/core';
import { BaseEntity } from '@oksai/core';

@Entity({ tableName: 'my_plugin_data' })
export class MyPluginData extends BaseEntity {
	@Property()
	name!: string;

	@Property()
	value!: string;
}
```

**æ’ä»¶ Serviceï¼š**

```typescript
@Injectable()
export class MyPluginDataService {
	constructor(
		@InjectRepository(MyPluginData)
		private readonly repo: EntityRepository<MyPluginData>
	) {}

	async create(name: string, value: string): Promise<MyPluginData> {
		const data = this.repo.create({ name, value });
		await this.em.persistAndFlush(data);
		return data;
	}

	async findAll(): Promise<MyPluginData[]> {
		return await this.repo.findAll();
	}
}
```

### API æ’ä»¶

**æ’ä»¶ Controllerï¼š**

```typescript
@Controller('my-plugin')
export class MyPluginController {
	constructor(private readonly myPluginDataService: MyPluginDataService) {}

	@Post()
	async create(@Body() body: { name: string; value: string }): Promise<MyPluginData> {
		return await this.myPluginDataService.create(body.name, body.value);
	}

	@Get()
	async findAll(): Promise<MyPluginData[]> {
		return await this.myPluginDataService.findAll();
	}
}
```

### é›†æˆæ’ä»¶

**é›†æˆæ’ä»¶ç¤ºä¾‹ï¼š**

```typescript
import { Injectable } from '@nestjs/common';
import { HttpService } from '@nestjs/axios';
import { IOksaisPluginBootstrap } from '@oksai/plugin';

@Injectable()
export class IntegrationPlugin implements IOksaisPluginBootstrap {
	constructor(private readonly httpService: HttpService) {}

	async onPluginBootstrap(): Promise<void> {
		console.log('Integration Plugin initialized');
		await this.connectToExternalService();
	}

	private async connectToExternalService(): Promise<void> {
		const response = await this.httpService.get('https://api.example.com').toPromise();
		console.log('Connected to external service', response.data);
	}
}
```

---

## æ’ä»¶é€šä¿¡

### äº‹ä»¶æœºåˆ¶

æ’ä»¶å¯ä»¥é€šè¿‡äº‹ä»¶æœºåˆ¶è¿›è¡Œé€šä¿¡ã€‚

**å‘é€äº‹ä»¶ï¼š**

```typescript
@Injectable()
export class MyPluginService {
	constructor(private readonly eventEmitter: EventEmitter2) {}

	async doSomething(): Promise<void> {
		this.eventEmitter.emit('my-plugin.event', { data: 'something' });
	}
}
```

**ç›‘å¬äº‹ä»¶ï¼š**

```typescript
@Injectable()
export class OtherPluginService {
	@OnEvent('my-plugin.event')
	handleMyPluginEvent(payload: any): void {
		console.log('Received event:', payload);
	}
}
```

### æœåŠ¡è°ƒç”¨

æ’ä»¶å¯ä»¥é€šè¿‡ä¾èµ–æ³¨å…¥è°ƒç”¨å…¶ä»–æ’ä»¶çš„æœåŠ¡ã€‚

**è°ƒç”¨å…¶ä»–æ’ä»¶æœåŠ¡ï¼š**

```typescript
@Injectable()
export class MyPluginService {
	constructor(private readonly otherPluginService: OtherPluginService) {}

	async doSomething(): Promise<void> {
		await this.otherPluginService.doSomethingElse();
	}
}
```

### æ•°æ®å…±äº«

æ’ä»¶å¯ä»¥é€šè¿‡å…±äº«çš„æ•°æ®åº“æ¨¡å‹æˆ–å…±äº«çš„ç¼“å­˜è¿›è¡Œæ•°æ®å…±äº«ã€‚

**å…±äº«æ•°æ®åº“æ¨¡å‹ï¼š**

```typescript
// å…±äº«çš„å®ä½“
@Entity({ tableName: 'shared_data' })
export class SharedData extends BaseEntity {
	@Property()
	data!: string;
}
```

---

## æ’ä»¶çƒ­åŠ è½½

### çƒ­åŠ è½½æœºåˆ¶

æ’ä»¶çƒ­åŠ è½½å…è®¸åœ¨ä¸é‡å¯åº”ç”¨çš„æƒ…å†µä¸‹åŠ¨æ€åŠ è½½å’Œå¸è½½æ’ä»¶ã€‚

**çƒ­åŠ è½½æµç¨‹ï¼š**

```mermaid
graph LR
    A[Plugin Changed] --> B[Detect Change]
    B --> C[Unload Old Plugin]
    C --> D[Load New Plugin]
    D --> E[Initialize Plugin]
```

### çƒ­åŠ è½½é…ç½®

**çƒ­åŠ è½½é…ç½®ï¼š**

```typescript
@Module({
	providers: [
		{
			provide: 'PLUGIN_LOADER',
			useFactory: () => ({
				watchPlugins: true,
				autoReload: true
			})
		}
	]
})
export class AppModule {}
```

### çƒ­åŠ è½½æœ€ä½³å®è·µ

**çƒ­åŠ è½½æœ€ä½³å®è·µï¼š**

-   **æ— çŠ¶æ€è®¾è®¡** - æ’ä»¶åº”è¯¥è®¾è®¡ä¸ºæ— çŠ¶æ€
-   **èµ„æºæ¸…ç†** - æ’ä»¶é”€æ¯æ—¶åº”è¯¥æ¸…ç†èµ„æº
-   **é”™è¯¯å¤„ç†** - çƒ­åŠ è½½å¤±è´¥æ—¶åº”è¯¥æœ‰é”™è¯¯å¤„ç†æœºåˆ¶

---

## ç°æœ‰æ’ä»¶å‚è€ƒ

### é›†æˆç±»æ’ä»¶

**é›†æˆç±»æ’ä»¶åˆ—è¡¨ï¼š**

1. **integration-github** - GitHub é›†æˆ
2. **integration-jira** - Jira é›†æˆ
3. **integration-zapier** - Zapier é›†æˆ
4. **integration-upwork** - Upwork é›†æˆ
5. **integration-hubstaff** - Hubstaff é›†æˆ
6. **integration-wakatime** - Wakatime é›†æˆ
7. **integration-activepieces** - Activepieces é›†æˆ
8. **integration-make-com** - Make.com é›†æˆ
9. **sentry-tracing** - Sentry è¿½è¸ª
10. **posthog** - Posthog åˆ†æ
11. **jitsu-analytics** - Jitsu åˆ†æ
12. **integration-ai** - AI é›†æˆ

### ä¸šåŠ¡åŠŸèƒ½æ’ä»¶

**ä¸šåŠ¡åŠŸèƒ½æ’ä»¶åˆ—è¡¨ï¼š**

13. **changelog** - å˜æ›´æ—¥å¿—
14. **knowledge-base** - çŸ¥è¯†åº“
15. **registry** - æ’ä»¶æ³¨å†Œè¡¨
16. **job-proposal** - å·¥ä½œææ¡ˆ
17. **job-search** - å·¥ä½œæœç´¢
18. **product-reviews** - äº§å“è¯„è®º
19. **videos** - è§†é¢‘
20. **camshot** - æ‘„åƒæˆªå›¾
21. **soundshot** - å£°éŸ³æˆªå›¾

### æ’ä»¶å‚è€ƒä»£ç 

æ‰€æœ‰æ’ä»¶å‚è€ƒä»£ç ä½äº `backup/plugins/` ç›®å½•ï¼Œå¯ä»¥å‚è€ƒè¿™äº›æ’ä»¶çš„ç»“æ„å’Œå®ç°ã€‚

---

## æ’ä»¶å‘å¸ƒ

### æ’ä»¶æ‰“åŒ…

**æ„å»ºæ’ä»¶ï¼š**

```bash
cd libs/plugins/<plugin-name>
pnpm run build
```

**æ’ä»¶åŒ…ç»“æ„ï¼š**

```
<plugin-name>/
â”œâ”€â”€ dist/
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ index.d.ts
â”‚   â”‚   â”œâ”€â”€ <plugin-name>.module.js
â”‚   â”‚   â””â”€â”€ ...
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

### æ’ä»¶å‘å¸ƒåˆ° npm

**å‘å¸ƒæ’ä»¶ï¼š**

```bash
cd libs/plugins/<plugin-name>
pnpm publish
```

**package.json é…ç½®ï¼š**

```json
{
	"name": "@oksai/plugin-<plugin-name>",
	"version": "1.0.0",
	"description": "Plugin description",
	"main": "dist/index.js",
	"types": "dist/index.d.ts",
	"files": ["dist"],
	"repository": {
		"type": "git",
		"url": "https://github.com/oksais/platform"
	},
	"keywords": ["oksai", "plugin"],
	"author": "OKSAI Platform Team",
	"license": "AGPL-3.0"
}
```

### æ’ä»¶å‘å¸ƒåˆ°ç§æœ‰ä»“åº“

**å‘å¸ƒåˆ°ç§æœ‰ä»“åº“ï¼š**

```bash
cd libs/plugins/<plugin-name>
pnpm publish --registry=https://registry.npmjs.org/
```

---

## å¸¸è§é—®é¢˜

### å¼€å‘ç›¸å…³

**Q: å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ–°çš„æ’ä»¶ï¼Ÿ**

A: å‚è€ƒ [åˆ›å»ºæ’ä»¶](#åˆ›å»ºæ’ä»¶) ç« èŠ‚ã€‚

**Q: å¦‚ä½•è°ƒè¯•æ’ä»¶ï¼Ÿ**

A: ä½¿ç”¨ VS Code çš„è°ƒè¯•åŠŸèƒ½ï¼Œè®¾ç½®æ–­ç‚¹è°ƒè¯•æ’ä»¶ä»£ç ã€‚

**Q: å¦‚ä½•åœ¨æ’ä»¶ä¸­ä½¿ç”¨æ•°æ®åº“ï¼Ÿ**

A: ä½¿ç”¨ MikroORM çš„ EntityManager åœ¨æ’ä»¶ä¸­è®¿é—®æ•°æ®åº“ã€‚

### æµ‹è¯•ç›¸å…³

**Q: å¦‚ä½•æµ‹è¯•æ’ä»¶ï¼Ÿ**

A: å‚è€ƒ [æ’ä»¶æµ‹è¯•](#æ’ä»¶æµ‹è¯•) ç« èŠ‚ã€‚

**Q: å¦‚ä½•æ¨¡æ‹Ÿæ’ä»¶çš„ä¾èµ–ï¼Ÿ**

A: ä½¿ç”¨ Jest çš„ Mock åŠŸèƒ½æ¨¡æ‹Ÿæ’ä»¶çš„ä¾èµ–ã€‚

### éƒ¨ç½²ç›¸å…³

**Q: å¦‚ä½•éƒ¨ç½²æ’ä»¶ï¼Ÿ**

A: æ’ä»¶éšåº”ç”¨ä¸€èµ·éƒ¨ç½²ï¼Œæ— éœ€å•ç‹¬éƒ¨ç½²ã€‚

**Q: å¦‚ä½•æ›´æ–°æ’ä»¶ï¼Ÿ**

A: æ›´æ–°æ’ä»¶ç‰ˆæœ¬ï¼Œé‡æ–°æ„å»ºå’Œéƒ¨ç½²åº”ç”¨ã€‚

---

## ç‰ˆæœ¬ä¿¡æ¯

-   **æ–‡æ¡£ç‰ˆæœ¬ï¼š** 1.0.0
-   **æœ€åæ›´æ–°ï¼š** 2026-02-04
-   **ç»´æŠ¤è€…ï¼š** OKSAI å¹³å°å›¢é˜Ÿ
